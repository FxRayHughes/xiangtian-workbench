<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>自动升级</title>
  <script src="../../ext/vue/vue.js"></script>
  <script src="../../ext/vue/antd.min.js"></script>
  <link rel="stylesheet" href="../../ext/vue/antd.min.css"/>
</head>
<body>
<script>
  Vue.use(antd)
</script>
<div id="appVue">
  <template>
    <a-result title="您有新的升级可用">
<!--      <template #extra>-->
<!--        <a-button key="console" type="primary">-->
<!--          下载更新-->
<!--        </a-button>-->
<!--      -->
<!--       -->
<!--      </template>-->
      <div class="desc">
        <p style="font-size: 16px;">
          <strong>新版本信息如下：</strong>
        </p>
        <p>
           版本号：v{{ info.version }}
          <a>了解更多 &gt;</a>
        </p>
        <p>
          发布日期： {{ info.releaseDate }}
        </p>
      </div>
      <template #extra>
        <a-button @click="startInstall()" type="primary">
          重启并安装更新
        </a-button>
        <a-button @click="cancel()">
         暂不更新
        </a-button>
      </template>
    </a-result>

  </template>
</div>
<script>
  const ipc=require('electron').ipcRenderer
  let appVue = new Vue({
    el: '#appVue',
    components: {},
    data () {
      return {
          info:{
            version:'读取数据中',
            releaseDate:'读取数据中'
          }
      }
    },
    mounted(){

    },
    methods:{
      startInstall(){
        ipc.send('startInstall')
      },
      cancel(){
         ipc.send('closeUpdate')
      }
    }
  })
  ipc.on('downloadProgress',(args)=>{
    console.log(args)
  })
  ipc.on('getInfo',(event,updateInfo)=>{
    // files: [{…}]
    // path: "想天浏览器 Setup 0.8.6.exe"
    // releaseDate: "2021-11-09T12:54:39.593Z"
    // sha512: "ercXqvkbZdTDhR4u1YjXsvrqurXIsWuX52iCSToCeT3dDMWOt9mRUc/sCqDh3UoxBXv84Kd+bpZgJs3BG2mEJw=="
    // version: "0.8.6"
    appVue.info=updateInfo
    console.log(updateInfo)
  })
</script>
<style >
  .desc p {
    margin-bottom: 1em;
  }
</style>
</body>
</html>

