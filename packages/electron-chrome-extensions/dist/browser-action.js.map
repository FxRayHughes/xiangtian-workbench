{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/browser-action.ts","webpack:///external \"electron\"","webpack:///external \"events\""],"names":["injectBrowserAction","actionMap","Map","internalEmitter","EventEmitter","observerCounts","invoke","name","partition","args","ipcRenderer","browserAction","addEventListener","listener","addListener","removeEventListener","removeListener","getAction","extensionId","get","getState","state","action","actions","set","id","queueMicrotask","emit","activate","details","addObserver","count","has","removeObserver","Math","max","on","keys","mainWorldScript","DEFAULT_PARTITION","BrowserActionElement","HTMLButtonElement","getAttribute","setAttribute","tab","tabId","parseInt","isNaN","removeAttribute","observedAttributes","constructor","updateId","badge","pendingIcon","onClick","bind","onContextMenu","connectedCallback","isConnected","update","disconnectedCallback","cancelAnimationFrame","undefined","attributeChangedCallback","event","rect","getBoundingClientRect","eventType","type","anchorRect","x","left","y","top","width","height","stopImmediatePropagation","preventDefault","getBadge","document","createElement","className","part","appendChild","requestAnimationFrame","updateCallback","updateIcon","info","iconSize","resizeType","timeParam","iconModified","iconUrl","bgImage","img","Image","onload","style","backgroundImage","src","activeTabId","tabInfo","tabs","title","text","textContent","color","backgroundColor","remove","customElements","define","extends","BrowserActionListElement","HTMLElement","observing","fetchState","console","error","browserActionNode","shadowRoot","querySelector","node","is","attachShadow","mode","startObserving","stopObserving","oldValue","newValue","contextBridge","exposeInMainWorld","webFrame","executeJavaScript"],"mappings":"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","file":"browser-action.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/browser-action.ts\");\n","import { ipcRenderer, contextBridge, webFrame } from 'electron'\r\nimport { EventEmitter } from 'events'\r\n\r\nexport const injectBrowserAction = () => {\r\n  const actionMap = new Map<string, any>()\r\n  const internalEmitter = new EventEmitter()\r\n  const observerCounts = new Map<string, number>()\r\n\r\n  const invoke = <T>(name: string, partition: string, ...args: any[]): Promise<T> => {\r\n    return ipcRenderer.invoke('crx-msg-remote', partition, name, ...args)\r\n  }\r\n\r\n  interface ActivateDetails {\r\n    eventType: string\r\n    extensionId: string\r\n    tabId: number\r\n    anchorRect: { x: number; y: number; width: number; height: number }\r\n  }\r\n\r\n  const browserAction = {\r\n    addEventListener(name: string, listener: (...args: any[]) => void) {\r\n      internalEmitter.addListener(name, listener)\r\n    },\r\n    removeEventListener(name: string, listener: (...args: any[]) => void) {\r\n      internalEmitter.removeListener(name, listener)\r\n    },\r\n\r\n    getAction(extensionId: string) {\r\n      return actionMap.get(extensionId)\r\n    },\r\n    async getState(partition: string): Promise<{ activeTabId?: number; actions: any[] }> {\r\n      const state = await invoke<any>('browserAction.getState', partition)\r\n      for (const action of state.actions) {\r\n        actionMap.set(action.id, action)\r\n      }\r\n      queueMicrotask(() => internalEmitter.emit('update', state))\r\n      return state\r\n    },\r\n\r\n    activate: (partition: string, details: ActivateDetails) => {\r\n      return invoke('browserAction.activate', partition, details)\r\n    },\r\n\r\n    addObserver(partition: string) {\r\n      let count = observerCounts.has(partition) ? observerCounts.get(partition)! : 0\r\n      count = count + 1\r\n      observerCounts.set(partition, count)\r\n\r\n      if (count === 1) {\r\n        invoke('browserAction.addObserver', partition)\r\n      }\r\n    },\r\n    removeObserver(partition: string) {\r\n      let count = observerCounts.has(partition) ? observerCounts.get(partition)! : 0\r\n      count = Math.max(count - 1, 0)\r\n      observerCounts.set(partition, count)\r\n\r\n      if (count === 0) {\r\n        invoke('browserAction.removeObserver', partition)\r\n      }\r\n    },\r\n  }\r\n\r\n  ipcRenderer.on('browserAction.update', () => {\r\n    for (const partition of observerCounts.keys()) {\r\n      browserAction.getState(partition)\r\n    }\r\n  })\r\n\r\n  // Function body to run in the main world.\r\n  // IMPORTANT: This must be self-contained, no closure variables can be used!\r\n  function mainWorldScript() {\r\n    const DEFAULT_PARTITION = '_self'\r\n\r\n    class BrowserActionElement extends HTMLButtonElement {\r\n      private updateId?: number\r\n      private badge?: HTMLDivElement\r\n      private pendingIcon?: HTMLImageElement\r\n\r\n      get id(): string {\r\n        return this.getAttribute('id') || ''\r\n      }\r\n\r\n      set id(id: string) {\r\n        this.setAttribute('id', id)\r\n      }\r\n\r\n      get tab(): number {\r\n        const tabId = parseInt(this.getAttribute('tab') || '', 10)\r\n        return typeof tabId === 'number' && !isNaN(tabId) ? tabId : -1\r\n      }\r\n\r\n      set tab(tab: number) {\r\n        this.setAttribute('tab', `${tab}`)\r\n      }\r\n\r\n      get partition(): string | null {\r\n        return this.getAttribute('partition')\r\n      }\r\n\r\n      set partition(partition: string | null) {\r\n        if (partition) {\r\n          this.setAttribute('partition', partition)\r\n        } else {\r\n          this.removeAttribute('partition')\r\n        }\r\n      }\r\n\r\n      static get observedAttributes() {\r\n        return ['id', 'tab', 'partition']\r\n      }\r\n\r\n      constructor() {\r\n        super()\r\n\r\n        // TODO: event delegation\r\n        this.addEventListener('click', this.onClick.bind(this))\r\n        this.addEventListener('contextmenu', this.onContextMenu.bind(this))\r\n      }\r\n\r\n      connectedCallback() {\r\n        if (this.isConnected) {\r\n          this.update()\r\n        }\r\n      }\r\n\r\n      disconnectedCallback() {\r\n        if (this.updateId) {\r\n          cancelAnimationFrame(this.updateId)\r\n          this.updateId = undefined\r\n        }\r\n        if (this.pendingIcon) {\r\n          this.pendingIcon = undefined\r\n        }\r\n      }\r\n\r\n      attributeChangedCallback() {\r\n        if (this.isConnected) {\r\n          this.update()\r\n        }\r\n      }\r\n\r\n      private activate(event: Event) {\r\n        const rect = this.getBoundingClientRect()\r\n\r\n        browserAction.activate(this.partition || DEFAULT_PARTITION, {\r\n          eventType: event.type,\r\n          extensionId: this.id,\r\n          tabId: this.tab,\r\n          anchorRect: {\r\n            x: rect.left,\r\n            y: rect.top,\r\n            width: rect.width,\r\n            height: rect.height,\r\n          },\r\n        })\r\n      }\r\n\r\n      private onClick(event: MouseEvent) {\r\n        this.activate(event)\r\n      }\r\n\r\n      private onContextMenu(event: MouseEvent) {\r\n        event.stopImmediatePropagation()\r\n        event.preventDefault()\r\n\r\n        this.activate(event)\r\n      }\r\n\r\n      private getBadge() {\r\n        let badge = this.badge\r\n        if (!badge) {\r\n          this.badge = badge = document.createElement('div')\r\n          badge.className = 'badge'\r\n          ;(badge as any).part = 'badge'\r\n          this.appendChild(badge)\r\n        }\r\n        return badge\r\n      }\r\n\r\n      private update() {\r\n        if (this.updateId) return\r\n        this.updateId = requestAnimationFrame(this.updateCallback.bind(this))\r\n      }\r\n\r\n      private updateIcon(info: any) {\r\n        const iconSize = 32\r\n        const resizeType = 2\r\n        const timeParam = info.iconModified ? `&t=${info.iconModified}` : ''\r\n        const iconUrl = `crx://extension-icon/${this.id}/${iconSize}/${resizeType}?tabId=${this.tab}${timeParam}`\r\n        const bgImage = `url(${iconUrl})`\r\n\r\n        if (this.pendingIcon) {\r\n          this.pendingIcon = undefined\r\n        }\r\n\r\n        // Preload icon to prevent it from blinking\r\n        const img = (this.pendingIcon = new Image())\r\n        img.onload = () => {\r\n          if (this.isConnected) {\r\n            this.style.backgroundImage = bgImage\r\n            this.pendingIcon = undefined\r\n          }\r\n        }\r\n        img.src = iconUrl\r\n      }\r\n\r\n      private updateCallback() {\r\n        this.updateId = undefined\r\n\r\n        const action = browserAction.getAction(this.id)\r\n\r\n        const activeTabId = this.tab\r\n        const tabInfo = activeTabId > -1 ? action.tabs[activeTabId] : {}\r\n        const info = { ...tabInfo, ...action }\r\n\r\n        this.title = typeof info.title === 'string' ? info.title : ''\r\n\r\n        this.updateIcon(info)\r\n\r\n        if (info.text) {\r\n          const badge = this.getBadge()\r\n          badge.textContent = info.text\r\n          badge.style.color = '#fff' // TODO: determine bg lightness?\r\n          badge.style.backgroundColor = info.color\r\n        } else if (this.badge) {\r\n          this.badge.remove()\r\n          this.badge = undefined\r\n        }\r\n      }\r\n    }\r\n\r\n    customElements.define('browser-action', BrowserActionElement, { extends: 'button' })\r\n\r\n    class BrowserActionListElement extends HTMLElement {\r\n      private observing: boolean = false\r\n\r\n      get tab(): number | null {\r\n        const tabId = parseInt(this.getAttribute('tab') || '', 10)\r\n        return typeof tabId === 'number' && !isNaN(tabId) ? tabId : null\r\n      }\r\n\r\n      set tab(tab: number | null) {\r\n        if (typeof tab === 'number') {\r\n          this.setAttribute('tab', `${tab}`)\r\n        } else {\r\n          this.removeAttribute('tab')\r\n        }\r\n      }\r\n\r\n      get partition(): string | null {\r\n        return this.getAttribute('partition')\r\n      }\r\n\r\n      set partition(partition: string | null) {\r\n        if (partition) {\r\n          this.setAttribute('partition', partition)\r\n        } else {\r\n          this.removeAttribute('partition')\r\n        }\r\n      }\r\n\r\n      static get observedAttributes() {\r\n        return ['tab', 'partition']\r\n      }\r\n\r\n      constructor() {\r\n        super()\r\n\r\n        const shadowRoot = this.attachShadow({ mode: 'open' })\r\n\r\n        const style = document.createElement('style')\r\n        style.textContent = `\r\n:host {\r\n  display: flex;\r\n  flex-direction: row;\r\n  gap: 5px;\r\n}\r\n\r\n.action {\r\n  width: 28px;\r\n  height: 28px;\r\n  background-color: transparent;\r\n  background-position: center;\r\n  background-repeat: no-repeat;\r\n  background-size: 70%;\r\n  border: none;\r\n  border-radius: 4px;\r\n  padding: 0;\r\n  position: relative;\r\n  outline: none;\r\n}\r\n\r\n.action:hover {\r\n  background-color: var(--browser-action-hover-bg, rgba(255, 255, 255, 0.3));\r\n}\r\n\r\n.badge {\r\n  box-shadow: 0px 0px 1px 1px var(--browser-action-badge-outline, #444);\r\n  box-sizing: border-box;\r\n  max-width: 100%;\r\n  height: 12px;\r\n  padding: 0 2px;\r\n  border-radius: 2px;\r\n  position: absolute;\r\n  bottom: 1px;\r\n  right: 0;\r\n  pointer-events: none;\r\n  line-height: 1.5;\r\n  font-size: 9px;\r\n  font-weight: 400;\r\n  overflow: hidden;\r\n  white-space: nowrap;\r\n}`\r\n        shadowRoot.appendChild(style)\r\n      }\r\n\r\n      connectedCallback() {\r\n        if (this.isConnected) {\r\n          this.startObserving()\r\n          this.fetchState()\r\n        }\r\n      }\r\n\r\n      disconnectedCallback() {\r\n        this.stopObserving()\r\n      }\r\n\r\n      attributeChangedCallback(name: string, oldValue: any, newValue: any) {\r\n        if (oldValue === newValue) return\r\n\r\n        if (this.isConnected) {\r\n          this.fetchState()\r\n        }\r\n      }\r\n\r\n      private startObserving() {\r\n        if (this.observing) return\r\n        browserAction.addEventListener('update', this.update)\r\n        browserAction.addObserver(this.partition || DEFAULT_PARTITION)\r\n        this.observing = true\r\n      }\r\n\r\n      private stopObserving() {\r\n        if (!this.observing) return\r\n        browserAction.removeEventListener('update', this.update)\r\n        browserAction.removeObserver(this.partition || DEFAULT_PARTITION)\r\n        this.observing = false\r\n      }\r\n\r\n      private fetchState = async () => {\r\n        try {\r\n          await browserAction.getState(this.partition || DEFAULT_PARTITION)\r\n        } catch {\r\n          console.error(\r\n            `browser-action-list failed to update [tab: ${this.tab}, partition: '${this.partition}']`\r\n          )\r\n        }\r\n      }\r\n\r\n      private update = (state: any) => {\r\n        const tabId =\r\n          typeof this.tab === 'number' && this.tab >= 0 ? this.tab : state.activeTabId || -1\r\n\r\n        for (const action of state.actions) {\r\n          let browserActionNode = this.shadowRoot?.querySelector(\r\n            `[id=${action.id}]`\r\n          ) as BrowserActionElement\r\n\r\n          if (!browserActionNode) {\r\n            const node = document.createElement('button', {\r\n              is: 'browser-action',\r\n            }) as BrowserActionElement\r\n            node.id = action.id\r\n            node.className = 'action'\r\n            ;(node as any).part = 'action'\r\n            browserActionNode = node\r\n            this.shadowRoot?.appendChild(browserActionNode)\r\n          }\r\n\r\n          if (this.partition) browserActionNode.partition = this.partition\r\n          browserActionNode.tab = tabId\r\n        }\r\n      }\r\n    }\r\n\r\n    customElements.define('browser-action-list', BrowserActionListElement)\r\n  }\r\n\r\n  try {\r\n    contextBridge.exposeInMainWorld('browserAction', browserAction)\r\n\r\n    // Must execute script in main world to modify custom component registry.\r\n    webFrame.executeJavaScript(`(${mainWorldScript}());`)\r\n  } catch {\r\n    // When contextIsolation is disabled, contextBridge will throw an error.\r\n    // If that's the case, we're in the main world so we can just execute our\r\n    // function.\r\n    mainWorldScript()\r\n  }\r\n}\r\n","module.exports = require(\"electron\");","module.exports = require(\"events\");"],"sourceRoot":""}